# 实施方案
## 模型修改
1. 新增boom_season_schedule模型
```sql
CREATE TABLE `boom_season_schedule` (
  `id` bigint(11) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `schedule_id` varchar(64) NOT NULL COMMENT '时间表id',
  `schedule_name` varchar(30) NOT NULL COMMENT '时间表名称',
  `schedule` json NOT NULL COMMENT '旺季时间表配置目',
  `is_delete` tinyint(2) unsigned NOT NULL DEFAULT '2' COMMENT '是否已删除 | 1 删除 2未删除',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  `create_uid` bigint(22) NOT NULL COMMENT '创建人uid',
  `update_uid` bigint(22) NOT NULL DEFAULT '0' COMMENT '更新人uid',
  PRIMARY KEY (`id`) COMMENT '自增主键',
  UNIQUE KEY `uk_coupon_typ_id` (`schedule_id`),
  KEY `idx_schedule_id` (`schedule_id`)
) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=utf8mb4 COMMENT='旺季时间表'
```
2. spu_hotel模型修改  
   spu_hotel中增加schedule_id
```sql
alter table spu_hotel add schedule_id varchar(64) not null default '' comment '旺季时间表Id' after update_uid;
alter table spu_hotel add refundable_time Integer not null default 1 comment '入住前多少天可售后' after schedule_id;
alter table spu_hotel add schedule_mode tinyint(2) not null default 0 comment '是否启用旺季时间表| 1:启用 0:不启用' after refundable_time;
```

3. spu_hotel_snapshot模型修改
```sql
alter table spu_hotel_snapshot add schedule_id varchar(64) not null default '' comment '旺季时间表Id' after update_uid;
alter table spu_hotel_snapshot add refundable_time Integer not null default 1 comment '入住前多少天可售后' after schedule_id;
alter table spu_hotel_snapshot add schedule_mode tinyint(2) not null default 0 comment '是否启用旺季时间表| 1:启用 0:不启用' after refundable_time;
```
4. bs_static_data增加收款主体
```sql
INSERT INTO xp_lark_goods.bs_static_data (code_type, code_value, code_name, code_desc, code_type_alias, sort_id, create_uid, create_time, update_uid, update_time, extern_code_type, is_delete) VALUES ('PAYEE', '5000', '小鹏服务公司', '', '', 0, 'pansf', CURRENT_TIMESTAMP, '', CURRENT_TIMESTAMP, '014005', 2);

```
## 接口细节
### 时间表相关
1. 创建时间表  
   请求示例
   ```json
    {
        "scheduleName" : "通用模板",
        "schedule" : [
            {
                "start" : 1234567891234,
                "end" : 1234567891234
            },
            {
                "start" : 1234567891234,
                "end" : 1234567891234
            },
            {
                "start" : 1234567891234,
                "end" : 1234567891234
            }
        ]
    }
   ```
   相应示例
   ```json
    {
        "code":200,
        "msg":"success",
        "data":null
    }
   ```
2. 更新时间表  
   请求示例
   ```json
    {
        "scheduleId" : "34234nsdf3434",
        "scheduleName" : "通用模板",
        "schedule" : [
            {
                "start" : 1234567891234,
                "end" : 1234567891234
            },
            {
                "start" : 1234567891234,
                "end" : 1234567891234
            },
            {
                "start" : 1234567891234,
                "end" : 1234567891234
            }
        ]
    }
   ```  
    相应示例
   ```json
    {
        "code":200,
        "msg":"success",
        "data":null
    }
   ```
3. 查询公有模板
   请求接口


4. 酒店管理后台
   1. 酒店模型增加三个字段
      ```java
      /**
       * 关联的旺季时间表id
       */
      private String scheduleId;
    
      /**
       * 是否应用旺季时间表配置| false:不启用 true：启用
       */
      private Boolean scheduleMode;
    
      /**
       * 淡季订单入住多少天前可以退（单位：天）
       */
      private Integer refundableTime;
      ```
      解释：  
      `refundableTime`：决定淡季订单入住前多少天可退，默认值设置为1。  
      `scheduleMode`：决定酒店是否启用旺季时间表配置，默认不启用。  
      `scheduleId`：酒店旺季时间表对应的id。  

      当酒店关闭时间表配置，则所有新订单均默认为淡季订单，可退时间（可售后时间）设置为`入住时间` - `refundableTime`，若`refundableTime`为1，即：入住前一天可退。

      因此HotelCreateParam/HotelUpdateParam中spu层级增加以上三个字段
