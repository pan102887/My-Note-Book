# 需求点

## 店铺-页面装修，组件中选择商品时增加筛选

1. 组件中选择商品时，支持筛选商品状态（在售/售罄/下架）目前运营同学手动选择时不便于排除售罄和下架商品。  

## 商品状态分栏新增已售罄商品

1. 商品分栏增加【已售罄的商品】

### 分析

1. 以上需求中所提及的两个功能点，均为对商品列表查询接口`/goods/pageList`提出更细化的查询能力要求。期望该接口能单独分页列出`售罄`状态的商品
2. 目前代码中显示，`Spu`中的`goodsStatus`字段（商品状态）有三个状态：
   - 1-销售中
   - 2-已售罄
   - 3-仓库中  

    然而经过测试，实际上商品的已售罄状态并没有使用`goodsStatus=2`来表示（后端没有相关逻辑，但是前端仍保留当goodsStatus=2时展示已售罄的逻辑），对于后端而言，goodsStatus实际上的有效值为{1, 3}。商品`已售罄`状态使用库存进行区分，当商品的goodsStatus=1，且该商品的所有规格的库存之和为0时，该商品状态显示为已售罄。

### 方案
1. 使用定时任务去维护这个goodsStatus字段的售罄状态，实现思路与当前的商品刷新缓存的定时任务思路一致。扫描过去一段时间内库存发生改变的商品，根据其当前库存以及商品状态，调整其商品状态。
2. 
