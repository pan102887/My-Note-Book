# 需求点
## 店铺-页面装修，组件中选择商品时增加筛选
1. 组件中选择商品时，支持筛选商品状态（在售/售罄/下架）目前运营同学手动选择时不便于排除售罄和下架商品。  
## 商品状态分栏新增已售罄商品
1. 商品分栏增加【已售罄的商品】

### 分析
1. 以上需求中所涉及的功能是由goodsPage接口提供，对于以上需求，goodsPage需要提供根据商品信息查询商品的功能。  

    当前代码: com.xiaopeng.xplarkgoods.boot.service.impl.SpuServiceImpl#pageList方法中，有这样的语句：`queryWrapper.in(Spu::getGoodsStatus, spuQueryParam.getSpuStatus());`看似提供了根据商品状态查询商品的功能，但实际上是一个错误语句。SpuQureyParam中的spuStatus是一个List<String>类型的参数，而Spu中的goodsStatus是一个Integer类型参数。因此该语句不能起正常作用。

    与此同时，com.xiaopeng.xplarkgoods.boot.service.impl.SpuServiceImpl#pageList方法中还有`queryWrapper.eq(Spu::getGoodsStatus, spuQueryParam.getGoodsStatus());`这样的语句。但是经过检查，Controller中并未传入goodsStatus这个参数，因而该逻辑尚未被正常使用。而且SpuQueryParam中的goodsStatus参数是Integer类型。因此一次查询只能查询一种指定结果。

    总结: SpuQueryParam中的spuStatus与goodsStatus两个参数存在功能上重复，类型不正确的问题。在此基础上进行修复改造便可实现根据商品状态查询商品的功能。

### 方案

为了能让商品分页查询接口具备根据商品状态查询商品的功能，这里给出以下方案  

1. 将SpuQueryParam中的spuStatus参数以及对应错误的逻辑代码删除，保留goodsStatus字段，将goodsStatus参数从Integer类型转换为List\<Integer\>类型，便于同时查询多种状态。与此同时，Controller中需要增加goodsStatus参数（原始代码中，service层使用到该参数但Controller没有传入），同时将  
`queryWrapper.eq(Spu::getGoodsStatus, spuQueryParam.getGoodsStatus());`  
更改为  
`queryWrapper.in(Spu::getGoodsStatus, spuQueryParam.getGoodsStatus());`  
删除spuStatus无效参数。

2. 删除无效字段`spuStatus`;将`goodsStatus`参数从 Integer类型调整为List\<Integer\>,并在controller层露出（原代码中controller没有将此参数作为入参）;