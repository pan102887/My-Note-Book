# 关于消息队列中间件的常见面试问题

## Kafka什么情况下可能会数据丢失？如何处理？

Kafka在以下几种情况下可能会发生数据丢失：

1. **生产者未正确配置**：如果生产者没有设置`acks=all`，可能会导致消息在发送过程中丢失。  
   **处理方法**：确保生产者配置了`acks=all`，以确保消息被所有副本确认后才算发送成功。

2. **消费者未正确处理**：如果消费者在处理消息时发生异常，可能会导致消息丢失。  
   **处理方法**：确保消费者在处理消息时能够正确捕获异常，并在必要时进行重试。

3. **Broker故障**：如果Kafka Broker发生故障，可能会导致未被确认的消息丢失。  
   **处理方法**：配置合理的副本数和ISR（In-Sync Replica）策略，以提高数据的可靠性。

4. **网络问题**：网络抖动或分区可能导致消息在传输过程中丢失。  
   **处理方法**：使用可靠的网络连接，并在生产者和消费者中实现重试机制。

5. **日志清理策略**：Kafka的日志清理策略可能会删除未被消费的消息。  
   **处理方法**：根据业务需求调整日志保留时间和大小，确保消息在被消费前不会被删除。