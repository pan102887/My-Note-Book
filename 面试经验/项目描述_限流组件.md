# 限流组件项目的描述

## 项目背景

之前我们的业务规模都比较小，所以当时我们的很多业务系统都没有做限流设计，但随着业务的发展，用户量日渐上升的同时，我们的运营投放需求也在不断增长。后来有一次运营在投放活动时，没有提前通知到位，系统没能做好扩容准备，一波突发流量进来把服务打挂了。

### 项目目标

于是我们决定开发一个限流组件，来保护我们的核心业务系统。我们大致列出了一些要求：

- （一个是）希望尽量利用项目当前现有的技术栈和中间件，避免引入一些不必要的额外成本。
- （再一个就是）希望能简单易用，方便各个业务系统去集成使用。
- （最重要的是）能有满足业务需求的限流策略，但又不过度设计引入不必要的复杂性。
- 要有良好的监控和告警机制，及时发现和处理限流事件。

### 选型过程

我们调研了市面上常见的限流中间件和方案，主要包括：

- 我们看了 **resilience4j**，它是Spring Cloud生态下的一个轻量级限流和熔断组件，但是它不支持分布式限流，由于我们是微服务架构，所以不太适合。
- **Guava 提供的 RateLimiter**也是一样的道理，它对分布式支持不够好，还不能满足我们的业务需求。
- 然后我们还看了**spring cloud gateway**： Spring Cloud生态下的API网关，虽然也非常符合我们的需求，但是由于我们的Spring Cloud版本较低，升级需要成本较高，所以暂时搁置。
- 再者就是阿里开源的**sentinel**：功能十分强大，支持多种限流策略，还自带监控平台，但是由于其功能超出我们当前的需求范围，以及它的复杂性和学习成本较高，比较重，也不利于其他系统的集成，因此我们最终也没采用。
- 最后我们选择了**redisson**：基于Redis的分布式限流组件，也比较贴合我们的系统架构，易于集成，性能也足够优越，能够满足我们的需求。

## 设计与实现

我们对Redisson中的RRateLimiter进行了一些封装，加入了一些定制化的功能，按照应用 + 接口层面的粒度进行设计。这套方案的限流算法使用的是令牌桶算法，在面对突发流量时能

## 效果
